create database laiterekisteri;
use laiterekisteri;

DROP TABLE IF EXISTS asiakas;
CREATE TABLE IF NOT EXISTS asiakas (
  ASIAKAS_ID int(11) NOT NULL UNIQUE AUTO_INCREMENT,
  NIMI varchar(50) CHARACTER SET latin1 NOT NULL,
  SALASANA varchar(50) CHARACTER SET latin1 NOT NULL,
  OSOITE varchar(50) CHARACTER SET latin1,
  POSTINRO varchar(5) CHARACTER SET latin1,
  POSTITMP varchar(50) CHARACTER SET latin1,
  PRIMARY KEY (`ASIAKAS_ID`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COLLATE=utf8_swedish_ci;
 
DROP TABLE IF EXISTS kategoria;
CREATE TABLE IF NOT EXISTS kategoria(
  KATEGORIA varchar(50) CHARACTER SET latin1 NOT NULL UNIQUE,
  PRIMARY KEY (`KATEGORIA`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COLLATE=utf8_swedish_ci;
 
DROP TABLE IF EXISTS laite;
CREATE TABLE IF NOT EXISTS laite(
  SARJANUMERO int(11) NOT NULL UNIQUE AUTO_INCREMENT,
  NIMI varchar(50) CHARACTER SET latin1 NOT NULL,
  MALLI varchar(50) CHARACTER  SET latin1 NOT NULL,
  MERKKI varchar(50) CHARACTER  SET latin1 NOT NULL,
  SIJAINTI varchar(50) CHARACTER  SET latin1 NOT NULL,
  KUVAUS varchar(50) CHARACTER  SET latin1 NOT NULL,
  KATEGORIA varchar(50) CHARACTER SET latin1 NOT NULL,
  STATUS_NIMI varchar(50) CHARACTER SET latin1,
  OMISTAJA varchar(50) CHARACTER SET latin1 NOT NULL,
  PRIMARY KEY (`SARJANUMERO`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COLLATE=utf8_swedish_ci;
 
DROP TABLE IF EXISTS status;
CREATE TABLE IF NOT EXISTS status (
  STATUS_NIMI varchar(50) CHARACTER SET latin1 NOT NULL UNIQUE,
  PRIMARY KEY (`STATUS_NIMI`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COLLATE=utf8_swedish_ci;
 
DROP TABLE IF EXISTS varaus;
CREATE TABLE IF NOT EXISTS varaus (
  VARAUS_ID int(11) NOT NULL UNIQUE AUTO_INCREMENT,
  SARJANUMERO int(11) NOT NULL,
  ALKUPVM date NOT NULL,
  LOPPUPVM date NOT NULL,
  STATUS_NIMI varchar(50) CHARACTER SET latin1 NOT NULL,
  ASIAKAS_ID int(11) NOT NULL,
  PRIMARY KEY (`VARAUS_ID`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COLLATE=utf8_swedish_ci;
 
ALTER TABLE varaus
ADD CONSTRAINT FK_laite
    FOREIGN KEY (SARJANUMERO) REFERENCES laite (SARJANUMERO),
 
ADD CONSTRAINT FK_asiakas
    FOREIGN KEY (ASIAKAS_ID) REFERENCES asiakas (ASIAKAS_ID),
 
ADD CONSTRAINT FK_status
    FOREIGN KEY (STATUS_NIMI) REFERENCES status (STATUS_NIMI);
   
ALTER TABLE laite
ADD CONSTRAINT FK_laitekategoria
    FOREIGN KEY (KATEGORIA) REFERENCES kategoria (KATEGORIA),

ADD CONSTRAINT FK_laitestatus
	FOREIGN KEY (STATUS_NIMI) REFERENCES status (STATUS_NIMI);


INSERT INTO status (STATUS_NIMI) VALUES ('LAINATTU'), ('VARATTU'), ('POISTETTU'), ('HUOLTO'), ('PALAUTETTU');
INSERT INTO kategoria (KATEGORIA) VALUES ('ELEKTRONIIKKA'), ('TAVARAT');


INSERT INTO laite (NIMI, MALLI, MERKKI, SIJAINTI, KUVAUS, KATEGORIA, OMISTAJA) VALUES
('PUHELIN', 'NOKIA', '3310', 'KUHMO', 'HYVALUURI', 'ELEKTRONIIKKA', 'JOONAS NISKANEN'),
('NÄYTTO', 'ACER', 'H123', 'KUOPIO', 'PELINAYTTO', 'ELEKTRONIIKKA', 'SEPPO TAALASMAA'),
('KIRVES', 'SUPERI', '2000', 'KUHMO', 'KOVAKIRVES', 'TAVARAT', 'JOONAS NISKANEN'),
('JAKOAVAIN', 'SUPERI', '9000', 'HELSINKI', 'NICEJAKOAVAIN', 'TAVARAT', 'ISMO LAITELA'),
('TABLETTI', 'APPLE', 'IPAD', 'KUOPIO', 'NICETABLETTI', 'ELEKTRONIIKKA', 'SEPPO TAALASMAA'),
('TIETOKONE', 'HP', 'PAVILLON', 'KUHMO', 'EPICTIETOKONE', 'ELEKTRONIIKKA', 'SAULI NIINISTO'),
('RUUVIMEISSELI', 'MUTTERIMIKA', '2444', 'KUHMO', 'HYVAMEISSELI', 'TAVARAT', 'JOONAS NISKANEN');7




